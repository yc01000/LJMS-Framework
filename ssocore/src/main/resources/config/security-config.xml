<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	   xmlns:sec="http://www.springframework.org/schema/security"
	   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd"
	   default-autowire="byName">

	<!-- security filter chain 미적용 -->
	<sec:http pattern="/js/**" security="none" />
	<sec:http pattern="/css/**" security="none" />
	<sec:http pattern="/font/**" security="none" />
	<sec:http pattern="/images/**" security="none" />
	<sec:http pattern="/i18n/messages/**" security="none" />
	<sec:http pattern="/mail/**" security="none" />
	<sec:http pattern="/batch/**" security="none" />
	<sec:http pattern="/file/**" security="none" />
	<sec:http pattern="/error/**" security="none" />
	<sec:http pattern="/force/**" security="none" />

	<!-- 포탈 로그인 후 페이지 전환 시 사용자 토큰을 이용한 로그인 처리 -->
	<bean id="ssoLoginCallbackFilter" class="com.lj.sso.ssocore.security.SsoLoginCallbackFilter" />

	<!-- 사용자 인증 불가 시 리다이렉트 처리 -->
	<bean id="ssoAuthenticationEntryPoint" class="com.lj.sso.ssocore.security.SsoAuthenticationEntryPoint" />

	<!-- 사용자 인증 정보 처리 -->
	<bean id="ssoAuthenticationProvider" class="com.lj.sso.ssocore.security.SsoAuthenticationProvider" />

	<sec:http auto-config="false" use-expressions="true" entry-point-ref="ssoAuthenticationEntryPoint">
		<sec:headers>
			<sec:frame-options policy="SAMEORIGIN"/>
		</sec:headers>

		<sec:csrf disabled="true" />

		<sec:intercept-url pattern="/**" access="hasRole('ROLE_USER')" />

		<sec:custom-filter ref="ssoLoginCallbackFilter" before="FIRST" />

		<sec:logout logout-url="/logout" logout-success-url="/" invalidate-session="true" />
	</sec:http>

	<sec:authentication-manager alias="authenticationManager">
		<sec:authentication-provider ref="ssoAuthenticationProvider" />
	</sec:authentication-manager>
</beans>
