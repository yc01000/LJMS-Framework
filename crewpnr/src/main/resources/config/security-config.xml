<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
		xmlns:sec="http://www.springframework.org/schema/security"
		xmlns:mvc="http://www.springframework.org/schema/mvc"
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns:util="http://www.springframework.org/schema/util"
		xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
						http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd
						http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"
		default-autowire="byName">

	<!-- security filter chain 미적용 -->
	<sec:http pattern="/js/**" security="none" />
	<sec:http pattern="/css/**" security="none" />
	<sec:http pattern="/font/**" security="none" />
	<sec:http pattern="/images/**" security="none" />
	<sec:http pattern="/i18n/messages/**" security="none" />
	<sec:http pattern="/mail/**" security="none" />
	<sec:http pattern="/batch/**" security="none" />
	<sec:http pattern="/file/**" security="none" />
	<sec:http pattern="/error/**" security="none" />
	<sec:http pattern="/force/**" security="none" />

	<!-- 스프링 security가 기본 제공 하는 PasswordEncoder -->
	<bean id="passwordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" />

<!-- 포탈 로그인 후 페이지 전환 시 사용자 토큰을 이용한 로그인 처리 -->
<!-- 	<bean id="ssoLoginCallbackFilter" class="com.lj.support.security.SsoLoginCallbackFilter" /> -->
	
	<!-- 포탈 로그인 후 페이지 전환 시 사용자 토큰을 이용한 로그인 처리 -->
	<bean id="ssoLoginCallbackFilter" class="com.lj.sso.ssocore.security.SsoLoginCallbackFilter" />

	<!-- AJAX 세션 타임아웃 필터 -->
	<bean id="ajaxSessionTimeoutFilter" class="com.lj.sso.ssocore.security.AjaxSessionTimeoutFilter" />

	<!-- 사용자 인증 불가 시 리다이렉트 처리 -->
	<bean id="ssoAuthenticationEntryPoint" class="com.lj.sso.ssocore.security.SsoAuthenticationEntryPoint" />

	<!-- 사용자 인증 정보 처리 -->
	<bean id="ssoAuthenticationProvider" class="com.lj.sso.ssocore.security.SsoAuthenticationProvider" />

	<sec:http auto-config="false" use-expressions="true" entry-point-ref="ssoAuthenticationEntryPoint">
		<sec:headers>
			<sec:frame-options policy="SAMEORIGIN"/>
		</sec:headers>

		<sec:intercept-url pattern="/**" access="hasRole('ROLE_USER')" />

		<sec:custom-filter ref="ssoLoginCallbackFilter" before="FIRST" />
		<sec:custom-filter ref="ajaxSessionTimeoutFilter" after="EXCEPTION_TRANSLATION_FILTER" />

		<sec:logout
			logout-url="/logout"
			logout-success-url="https://local-crewpnr.jinair.com"
			invalidate-session="true" />
	</sec:http>

	<sec:authentication-manager alias="authenticationManager">
		<sec:authentication-provider ref="ssoAuthenticationProvider" />
	</sec:authentication-manager>
</beans>